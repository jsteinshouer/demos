webpackJsonp([1],{10:function(e,t,s){s(25);var n=s(0)(s(21),s(207),null,null);e.exports=n.exports},11:function(e,t,s){s(29);var n=s(0)(s(23),s(211),null,null);e.exports=n.exports},14:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=s(13),r=n(a),i=s(12),o=n(i),c=s(4),l=n(c),d=s(5),u=n(d),v=s(1),p=n(v);s(3);var h=s(7),g=n(h),_=s(9),m=n(_),f=s(10),w=n(f),I=s(8),b=n(I),S=s(6),O=n(S),R=s(11),y=n(R);r.default.use(p.default),r.default.use(o.default);var C=[];C.push({path:"/injection",component:g.default}),C.push({path:"/authentication/intro",component:m.default}),C.push({path:"/authentication/mfa",component:w.default}),C.push({path:"/authentication/passwords",component:b.default}),C.push({path:"/authentication",component:O.default}),C.push({path:"/authentication/brute-force",component:y.default}),C.push({path:"*",component:u.default}),C.push({path:"/",name:"Home",component:u.default});var A=new o.default({routes:C});new r.default({el:"#app",router:A,template:"<App/>",components:{App:l.default}})},15:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},16:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{}},mounted:function(){document.currentSlide={}},methods:{click:function(e){e.stopPropagation()}}}},17:function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=s(1),r=n(a),i=s(205),o=n(i);t.default={mixins:[r.default.slideshow],components:{passwords:o.default}}},18:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},19:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},20:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},205:function(e,t,s){s(26);var n=s(0)(s(22),s(208),null,null);e.exports=n.exports},206:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"Injection"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:3,enter:"fadeIn",leave:"bounceOutLeft"}},[s("h3",[e._v("Injection")]),s("p",{staticClass:"center"},[e._v("An attacker uses input parameters to inject malicious code or commands to a vulnerable application")]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=2?s("p",[s("b",[e._v("SQL Injection")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=3?s("p",[s("b",[e._v("ORM Injection")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?s("p",[s("b",[e._v("LDAP Injection")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=3?s("p",[s("b",[e._v("XPath Injection")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?s("p",[s("b",[e._v("NoSQL Injection")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?s("p",[s("b",[e._v("OS Command Injection ")])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?s("p",[s("b",[e._v("Code Injection")]),e._v(".")]):e._e()])],1)]),s("slide",{attrs:{enter:"bounceInRight",leave:"bounceOutDown"}},[s("h3",[e._v("SQL Injection")]),s("p",[e._v("Common weakness of database driven web applications where SQL code is injected as an input parameter")])]),s("slide",{attrs:{steps:2}},[s("h3",[e._v("SQL Injection")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('userQuery = queryExecute("\n  select\n    p_user,\n    first_name,\n    last_name,\n    email,\n    phone,\n  from users\n  where p_user = #url.userID#\n");')])],1),s("eg-transition",{attrs:{enter:"bounceInLeft"}},[2==e.step?s("div",[2==e.step?s("h4",[e._v("Examples")]):e._e(),s("ul",[2==e.step?s("li",[s("code",[e._v("?userid=1 or 1=1")])]):e._e(),2==e.step?s("li",[s("code",[e._v("?userid=1;delete from clients`")])]):e._e()])]):e._e()])],1),s("slide",{attrs:{steps:2}},[s("h3",[e._v("SQL Injection")]),s("p",[e._v("Use query parameters to prevent these attacks.")]),s("eg-transition",{attrs:{enter:"bounceInDown"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('userQuery = queryExecute("\n  select\n    p_user,\n    first_name,\n    last_name,\n    email,\n    phone,\n  from users\n  where p_user = :userID\n",{ userID = url.userid });')]),s("p",[e._v("This will throw an error if malicious parameters are passed in.")])],1),s("eg-transition",{attrs:{enter:"zoomInX",leave:"zoomOutX"}},[2==e.step?s("p",[e._v("This will throw an error if malicious parameters are passed in.")]):e._e()])],1),s("slide",{attrs:{steps:2}},[s("h3",[e._v("SQL Injection")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('<cfquery name="myTasks">\n  SELECT \n    p_task,\n    description\n  FROM task\n  WHERE f_user = #url.id#\n</cfquery>\n\n<cfdump var="#myTasks#" >')]):e._e()],1),s("eg-transition",{attrs:{enter:"bounceInLeft"}},[2==e.step?s("div",[s("p",[s("code",[e._v("?id=1 or 1=1")]),e._v(" "),s("br"),s("code",[e._v("?id=1;delete from task")])]),2==e.step?s("img",{staticStyle:{"max-width":"100%"},attrs:{src:"/static/sql-injection-demo1.gif"}}):e._e()]):e._e()])],1),s("slide",{attrs:{steps:2}},[s("h3",[e._v("SQL Injection")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('<cfquery name="myTasks">\n  SELECT \n    p_task,\n    description\n  FROM task\n  WHERE f_user = <cfqueryparam cfsqltype="integer" value="#url.id#">\n</cfquery>\n\n<cfdump var="#myTasks#" >')]):e._e()],1),s("eg-transition",{attrs:{enter:"bounceInLeft"}},[2==e.step?s("div",[2==e.step?s("img",{staticStyle:{"max-width":"100%"},attrs:{src:"/static/sql-injection-demo2.gif"}}):e._e()]):e._e()])],1),s("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("ORM")]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"bounceInRight"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('ORMExecuteQuery("\n  from Orders\n  where OrderID=:orderid\n  and ProductID=:productid\n",{\n    orderid=1,\n    productid=901\n}, true)')])],1)],1),s("eg-transition",{attrs:{enter:"bounceInRight"}},[s("p",[e._v("ORM is vulnerable as well. Be sure to use sql parameters when filtering and searching in ORM as well.")])])],1),s("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("LDAP Injection")]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"fadeIn"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('departmentId = "Human Resources <CTO>";\nsearchStart = "ou=" & encodeForDN(departmentId) & ",dc=uconn,dc=edu";\ncfldap(\n    server = "ldap.uconn.edu",\n    action = "query",\n    name = "results" ,\n    start = "#searchStart#",\n    filter = "cn=Robert Jones" ,\n    attributes = "cn,description,o,title,mail,telephonenumber",\n    sort = "cn ASC");')])],1)],1),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",[e._v("Use "),s("code",[e._v("encodeForDN()")]),e._v(" for any parameters used in a cfldap query.")])])],1),s("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("XML/Xpath Injection")]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"fadeIn"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('encodeForXPath("\'or 1=1",false)')])],1)],1),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",[e._v("Use "),s("code",[e._v("encodeForXPath()")]),e._v(" for any parameters used in a XML queries.")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",[e._v("Expected Result: "),s("code",[e._v("&#x27;or 1&#x3d;1")])])])],1),s("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("Operating System (OS) Command Injection")]),s("p",{staticClass:"center"},[e._v("An type of injection where software executes OS commands and user can inject other commands as input")])]),s("slide",[s("h3",[e._v("Operating System (OS) Command Injection")]),s("eg-transition",{attrs:{enter:"bounceInLeft"}},[s("div",[s("h4",[e._v("Example")]),s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('cfexecute(\n  name="c:\\windows\\system32\\cmd.exe",\n  arguments="/c ping #url.host#",\n  variable="output",\n  timeout="10"\n);')]),s("p",[s("code",[e._v("?host=contactmanager %26 whoami")])])],1)])],1),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Operating System (OS) Command Injection")]),s("h4",[e._v("Prevention")]),s("ul",[e.step>=1?s("li",[e._v("Avoid using OS commands and use native libraries instead")]):e._e(),e.step>=2?s("li",[e._v("Use ESAPI "),s("code",[e._v("encodeForOS()")]),e._v(" method to escape special characters")]):e._e(),e.step>=3?s("li",[e._v("Use strict validation")]):e._e()])]),s("slide",[s("h3",[e._v("Operating System (OS) Command Injection")]),s("h1",{staticClass:"center"},[e._v("DEMO")])]),s("slide",{attrs:{steps:3,enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("Code Injection")]),s("p",{staticClass:"center"},[e._v("An attacker can inject language specific code that is then executed by the language interpreter.")]),e.step>=2?s("h4",[e._v("Example")]):e._e(),s("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=2?s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('<cfset myVariable = evaluate("myStruct.#url.key#")>')]):e._e()],1),s("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=3?s("h4",[e._v("Malicious URL String")]):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=3?s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('?key=key1 eq "zzz" or setVariable("session.role", "Administrator")\n')]):e._e()],1)],1),s("slide",{attrs:{steps:1,enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("Code Injection")]),s("h4",{staticClass:"center"},[e._v("Prevention")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",{staticClass:"center"},[e._v("Avoid using "),s("code",[e._v("evaluate()")]),e._v(" or "),s("code",[e._v("iif()")]),e._v(".")])])],1),s("slide",{attrs:{steps:3,enter:"bounceInRight"}},[s("h3",[e._v("Summary: Injection Prevention")]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[1==e.step?s("p",[s("b",[e._v("Perform proper input validation")]),s("ul",[s("li",[e._v("Whitelist validation")]),s("li",[e._v("Use functions such as "),s("code",[e._v("isValid()")]),e._v(" to validate user input")])])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[2==e.step?s("p",[s("b",[e._v("Use a safe API")]),s("ul",[s("li",[e._v("SQL Paramaters")]),s("li",[e._v("ESAPI Built in CF Functions:"),s("a",{attrs:{href:"https://cfdocs.org/encodefor",target:"_blank"}},[e._v("encodeFor*")])])])]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[3==e.step?s("p",[s("b",[e._v("Contextually escape user data")]),s("ul",[s("li",[e._v("If library is not available use "),s("code",[e._v("replace()")]),e._v(" or "),s("code",[e._v("reReplace()")]),e._v(" to remove uwanted characters.")])])]):e._e()])],1),s("slide",{attrs:{steps:1,enter:"bounceInRight",leave:"fadeOut"}},[s("h3",[e._v("Links")]),s("ul",[s("li",[s("a",{attrs:{href:"https://www.owasp.org/index.php/Top_10-2017_A1-Injection",target:"_blank"}},[e._v("OWASP: Top 10-2017 A1-Injection")])]),s("li",[s("a",{attrs:{href:"https://www.adobe.com/content/dam/acom/en/products/coldfusion/pdfs/cf11/cfml-developer-security-guide.pdf",target:"_blank"}},[e._v("CFML Developer Security Guide")])]),s("li",[s("a",{attrs:{href:"https://jasonsteinshouer.com/2018/05/18/owasp-top-10-injection.html",target:"_blank"}},[e._v("Blog Post")])])])])],1)])},staticRenderFns:[]}},207:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"MFA"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:2}},[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h2",[e._v("Multi-Factor Authentication")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[2==e.step?s("h5",{staticClass:"center"},[e._v("Use 2 or more authentication factors to prove the identity of a user.")]):e._e()])],1),s("slide",{attrs:{steps:3}},[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Multi-Factor Authentication")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[3==e.step?s("h5",{staticClass:"center"},[e._v("What are the factors?")]):e._e()])],1),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",{staticClass:"center"},[e._v("Something you know")])]),s("br"),s("eg-transition",{attrs:{enter:"bounceInRight"}},[2==e.step?s("h5",{staticClass:"center"},[e._v("Password")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[3==e.step?s("h5",{staticClass:"center"},[e._v("PIN")]):e._e()])],1),s("slide",{attrs:{steps:5}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",{staticClass:"center"},[e._v("Something you have")])]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[2==e.step?s("h5",{staticClass:"center"},[e._v("Physical Key")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[3==e.step?s("h5",{staticClass:"center"},[e._v("Debit Card")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[4==e.step?s("h5",{staticClass:"center"},[e._v("Hardware Tokens (RSA SecureID, SmartCard, USB Tokens, etc.)")]):e._e()]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"bounceInRight"}},[4==e.step?s("img",{attrs:{src:"https://qph.fs.quoracdn.net/main-qimg-a0339042588d0aef8a825fc351adf239"}}):e._e()])],1),s("eg-transition",{attrs:{enter:"bounceInRight"}},[5==e.step?s("h5",{staticClass:"center"},[e._v("Software Tokens (Mobile Phone)")]):e._e()]),s("div",{staticClass:"center"},[s("eg-transition",{attrs:{enter:"bounceInRight"}},[5==e.step?s("img",{staticClass:"center",attrs:{height:"400px",src:"https://lh3.googleusercontent.com/SClWEmbk7QxxuKiWshok2T45vAwEQYCduisnnGORqrha7KfpQsvFZa0xac_jyj_tE9Mn=w720-h310"}}):e._e()])],1)],1),s("slide",{attrs:{steps:6}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",{staticClass:"center"},[e._v("Something you are")])]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=2?s("h5",[e._v("Biometrics")]):e._e()]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=3?s("li",[e._v("Fingerprints")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=4?s("li",[e._v("Voice recognition")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=5?s("li",[e._v("Face recognition")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=6?s("li",[e._v("Iris scan")]):e._e()])],1)],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[s("h4",{staticClass:"center"},[e._v("Two-Factor Authentication")])]),s("eg-transition",{attrs:{enter:"bounceInRight"}},[s("h5",{staticClass:"center"},[e._v("Username/Password + Software Token (Mobile Phone)")])])],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",{staticClass:"center"},[e._v("Software Token (Mobile Phone)")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h5",{staticClass:"center"},[s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm",target:"_blank"}},[e._v("Time-based One-time Password algorithm (TOTP)")])])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("p",{staticClass:"center"},[e._v("Algorithm to generate one-time passwords for use with authentication. Generated at time intervals (Typically 30 seconds)")])])],1),s("slide",{attrs:{steps:4}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Mobile Apps")])]),s("ul",[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=2?s("li",[s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_US",target:"_blank"}},[e._v("Google Authenticator")])]):e._e()]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?s("li",[s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.authy.authy",target:"_blank"}},[e._v("Authy")])]):e._e()]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=4?s("li",[s("a",{attrs:{href:"https://play.google.com/store/search?q=2+factor+authentication&c=apps",target:"_blank"}},[e._v("Many Others")])]):e._e()])],1)],1),s("slide",{attrs:{steps:4}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Server Verification")])]),s("ul",[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=2?s("li",[s("a",{attrs:{href:"https://github.com/wstrange/GoogleAuth",target:"_blank"}},[e._v("wstrange/GoogleAuth")])]):e._e()]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?s("li",[s("a",{attrs:{href:"https://github.com/marcins/cf-google-authenticator",target:"_blank"}},[e._v("marcins/cf-google-authenticator")]),s("ul",[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?s("li",{staticClass:"sub-item"},[s("a",{attrs:{href:"http://junkheap.net/blog/2013/05/30/implementing-google-authenticator-support-in-coldfusion/",target:"_blank"}},[e._v("Implementing Google Authenticator Support in ColdFusion")])]):e._e()])],1)]):e._e()])],1)],1),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("SQL")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"sql"}},[e._v("ALTER TABLE [user] ADD two_factor_auth_enabled bit;"),s("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD FLAG TO DETERMINE IF USER HAS 2FA ENABLED")]),e._v("\nALTER TABLE [user] ADD two_factor_auth_key nvarchar(50);"),s("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD FIELD TO STORE SHARED KEY")])],1)],1)])],1),s("slide",{attrs:{steps:1}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("User.cfc")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",[e._v("Add cooresonding properties")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="twoFactorAuthenticationEnabled" type="boolean";\nproperty name="twoFactorAuthenticationKey" type="string";\n')])],1)])],1),s("slide",{attrs:{steps:1}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("UserDAO.cfc")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",[e._v("Add new sql fields to queries")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("SELECT\n  first_name,\n  last_name,\n  username,\n  two_factor_auth_enabled,\n  two_factor_auth_key\nFROM [user]\nWHERE\n  p_user = :userID\n")])],1)])],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("handlers/Settings.cfc: Injected properties")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="securityService" inject="security.SecurityService";\nproperty name="oneTimePasswordService" inject="security.OneTimePasswordService";\n')])],1)])],1),s("slide",{attrs:{steps:8}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("handlers/Settings.cfc: Called when a user enables 2FA")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("prc.user = securityService.getLoggedInUser(); "),s("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GET THE USER CURRENTLY LOGGED IN")]),e._v("\n\nif ( !prc.user.isTwoFactorAuthenticationEnabled() ) { "),s("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK IF 2FA IS ALREADY ENABLED")]),e._v("\n  prc.user.setTwoFactorAuthenticationKey( oneTimePasswordService.generateKey() ); "),s("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GENERATE A NEW KEY FOR THE USER")]),e._v("\n\n  userService.save( prc.user ); "),s("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SAVE THE USER RECORD")]),e._v("\n\n  prc.qrCodeImage = oneTimePasswordService.getOTPQRCode( "),s("eg-code-comment",{attrs:{active:7==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GENERATES A QR CODE FOR THE USER TO SETUP THE MOBILE APP")]),e._v('\n    name = "Recipe Box (#prc.user.getUsername()#)",\n    key = prc.user.getTwoFactorAuthenticationKey()\n  );\n\n  event.setView(view="settings/setup"); '),s("eg-code-comment",{attrs:{active:8==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VIEW TO SETUP 2FA")]),e._v('\n}\nelse {\n  setNextEvent("settings");\n}\n')],1)],1)])],1),s("slide",{attrs:{steps:4}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("h4",[e._v("views/settings/setup.cfm")]):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"markup"}},[e._v('<cfoutput>\n<div class="container" style="margin-top: 30px">\n  <h2>Two-Factor Authentication Setup</h2>\n  <p>Scan this code on your device with your authenticator application.</p>\n  <img src="data:image/*;base64,#toBase64( prc.qrCodeImage )#" height="300"/> '),s("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" DISPLAY QR CODE")]),e._v('\n  /> <br />\n  <div class="col-sm-4">\n  <form method="POST" action="#event.buildLink("settings.enableTwoFactorAuthentication")#">\n    <input type="text" name="passcode" class="form-control input-lg" placeholder="Passcode" required> '),s("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY THE OTP TO COMPLETE SETUP")]),e._v('\n    <span id="helpBlock" class="help-block">Enter the code from your authentication app here to complete 2-factor authentication setup.</span>\n    <button class="btn btn-lg btn-primary btn-block">Verify Code</button>\n  </form>\n  </div>\n  </form>\n</div>\n</cfoutput>\n')],1)],1):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[4==e.step?s("div",{staticClass:"center"},[s("img",{attrs:{src:"static/qr-code.png"}})]):e._e()])],1),s("slide",{attrs:{steps:4}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("h4",[e._v("handlers/Settings.cfc: Complete the setup")]):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"markup"}},[e._v('public void function enableTwoFactorAuthentication(event,rc,prc) {\n  prc.user = securityService.getLoggedInUser();\n  event.paramValue("passcode","");\n\n  if ( !prc.user.isTwoFactorAuthenticationEnabled() ) {\n    var key = prc.user.getTwoFactorAuthenticationKey();\n\n    if ( len( rc.passcode ) && oneTimePasswordService.verify( key, rc.passcode )  ) { '),s("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY OTP")]),e._v("\n\n      prc.user.setTwoFactorAuthenticationenabled( true );"),s("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SET 2FA ENABLED")]),e._v("\n\n      userService.save( prc.user ); "),s("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SAVE THE USER RECORD")]),e._v('\n      flash.put("message","2-Factor authentication setup successful.");\n\n    }\n    else {\n      prc.user.setTwoFactorAuthenticationEnabled( false );\n      prc.user.setTwoFactorAuthenticationKey( "" );\n      userService.save( prc.user );\n      flash.put("message","2-Factor authentication setup failed.");\n    }\n  }\n\n  setNextEvent("settings");\n}')],1)],1):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[4==e.step?s("div",{staticClass:"center"},[s("img",{attrs:{src:"static/qr-code.png",height:"300px"}})]):e._e()])],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h5",{staticClass:"center"},[e._v("Step 1")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("div",{staticClass:"center"},[s("img",{attrs:{src:"static/2fa-step1.png"}})])])],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h5",{staticClass:"center"},[e._v("Step 2")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("div",{staticClass:"center"},[s("img",{attrs:{src:"static/2fa-step2.png"}})])])],1),s("slide",{attrs:{steps:5}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("SecurityService.cfc: Step 1")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"markup"}},[e._v('public boolean function checkUsernameAndPassword(username,password) {\n\n  var isValid = false;\n  ....\n  if (\n    q.recordCount\n    && bcrypt.checkPassword(arguments.password,q.password)\n  ) {\n\n    sessionStorage.setVar( "step1Valid",true ); '),s("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SET SESSION VARIABLE THAT SAYS STEP 1 IS VALID")]),e._v('\n    var user = userService.get( q.p_user );\n    sessionStorage.setVar( "user", user ); '),s("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD USER TO THE SESSION")]),e._v('\n\n    if ( user.isTwoFactorAuthenticationEnabled() ) {\n      sessionStorage.setVar( "step2Required",true ); '),s("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SESSION VARIABLE TO SAY THAT 2FA IS ENABLED")]),e._v('\n    }\n    else {\n      sessionStorage.setVar( "isLoggedIn",true ); '),s("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" THE USER IS LOGGED IN IF 2FA IS NOT ENABLED")]),e._v("\n    }\n\n    isValid = true;\n  }\n  ....\n}\n\n")],1)],1)])],1),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Multi-Factor Authentication")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("h4",[e._v("SecurityService.cfc: Step 2")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"markup"}},[e._v("public boolean function verifyOneTimePassword( required string password ) {\n\n  var user = getLoggedInUser();\n\n  var isValid = oneTimePasswordService.verify( "),s("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY THAT THE ONE-TIME PASSWORD IS VALID")]),e._v('\n    key = user.getTwoFactorAuthenticationKey(),\n    userToken = arguments.password\n  );\n\n  if ( isValid ) {\n    sessionStorage.setVar("isLoggedIn",true); '),s("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" USER LOGGED IN")]),e._v("\n  }\n\n  return isValid;\n}\n")],1)],1)])],1),s("slide",[s("h3",[e._v("Multi-Factor Authentication")]),s("h5",{staticClass:"center"},[e._v("LIVE DEMO")])]),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Multi-Factor Authentication")]),s("h5",[e._v("Other Methods")]),s("ul",[s("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?s("li",[e._v("SMS")]):e._e()]),s("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?s("li",[e._v("Push Notifications")]):e._e()])],1)]),s("slide",{attrs:{steps:3}},[s("h3",[e._v("Multi-Factor Authentication")]),s("h5",[e._v("3rd-party Service Providers")]),s("ul",[s("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?s("li",[s("a",{attrs:{href:"https://duo.com",target:"_blank"}},[e._v("DUO")])]):e._e()]),s("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?s("li",[s("a",{attrs:{href:"https://www.okta.com",target:"_blank"}},[e._v("okta")])]):e._e()]),s("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?s("li",[s("a",{attrs:{href:"https://auth0.com/multifactor-authentication",target:"_blank"}},[e._v("Auth0")])]):e._e()])],1)]),s("slide",[s("div",{staticClass:"center"},[s("h2",[e._v("Questions?")]),s("a",{attrs:{href:"/"}},[e._v("Back Home")])])])],1)])},staticRenderFns:[]}},208:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"Passwords"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{enter:"bounceInRight"}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("Password Complexity Requirements")]),s("ul",[s("li",[e._v("Must be at least 10 characters, allowing up to 128")]),s("li",[e._v("Must meet 3 of 4 complexity rules"),s("ul",[s("li",{staticClass:"sub-item"},[e._v("at least 1 uppercase character (A-Z)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 lowercase character (a-z)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 digit (0-9)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 special character ("),s("a",{attrs:{href:"https://www.owasp.org/index.php/Password_special_characters",target:"_blank"}},[e._v("punctuation")]),e._v(") — do not forget to treat space as special characters too")])])])])]),s("slide",{attrs:{steps:8}},[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  var isValid = false;\n  var specialCharacterRegEx = "[ ""\'\\(\\)\\+,-\\./\\:\\;<=>\\?\\[\\]\\\\_`\\{\\}\\|~!@##\\$%\\^&\\*]";\n\n  if (\n    len(arguments.password) >= 10 '),s("eg-code-comment",{attrs:{active:2===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT LEAST 10 CHARACTERS")]),e._v("\n    && len(arguments.password) < 128 ) { "),s("eg-code-comment",{attrs:{active:3===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT MOST 128 CHARACTERS")]),e._v('\n\n    var complexityCount = (\n        ( reFind("[a-z]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:4===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR LOWERCASE")]),e._v('\n      + ( reFind("[A-Z]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:5===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR UPPERCASE")]),e._v('\n      + ( reFind("[0-9]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:6===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR DIGITS")]),e._v("\n      + ( reFind(specialCharacterRegEx,arguments.password) ? 1 : 0 ) "),s("eg-code-comment",{attrs:{active:7===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR SPECIAL CHARACTERS")]),e._v("\n    );\n\n    isValid = complexityCount >= 3; "),s("eg-code-comment",{attrs:{active:8===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" MUST HAVE AT LEAST 3 of 4")]),e._v("\n\n  }\n\n  return isValid;\n}\n")],1)],1)],1),s("slide",[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{staticClass:"center"},[s("img",{style:{height:"16em"},attrs:{src:"https://imgs.xkcd.com/comics/password_strength.png"}}),s("p",[e._v("xkcd.com")])])])],1),s("slide",[s("h3",[e._v("Password Strength")]),s("h4",{staticClass:"center"},[e._v("New NIST Password Guidelines")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("ul",[s("li",[e._v("Must be at least 8 characters, allowing up to 64")]),s("li",[e._v("The maximum should be at least 64 characters")]),s("li",[e._v("Allow all ASCII and UNICODE characters, including emoji")]),s("li",[e._v("Eliminate any other complexity requirements")])])])],1),s("slide",[s("h3",[e._v("Password Strength")]),s("h4",{staticClass:"center"},[e._v("New NIST Password Guidelines")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  return\n    len(arguments.password) >= 8\n    && len(arguments.password) < 128\n}\n\nvalidatePassword("🙈🙉🙊thisworks"); '),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Valid")])],1)],1)],1),s("slide",[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",[e._v("New NIST Password Guidelines Cont...")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("ul",[s("li",[e._v("Offer guidance to the user when creating passwords (Passphrases, Meters)")])])])],1),s("slide",[s("eg-transition",{attrs:{enter:"slideInRight"}},[s("p",[s("iframe",{staticStyle:{width:"100%"},attrs:{height:"550",scrolling:"no",title:"Password Meter",src:"//codepen.io/jsteinshouer/embed/YjPaKv/?height=550&theme-id=0&default-tab=result",frameborder:"no",allowtransparency:"true",allowfullscreen:"true"}}),s("a",{attrs:{href:"https://jasonsteinshouer.com/2018/07/13/owasp-top-10-broken-authentication-password-guidance.html",target:"_blank"}},[e._v("Blog Post")])],1)])],1),s("slide",[s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h3",[e._v("Password Strength")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",[e._v("New NIST Password Guidelines Cont...")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("ul",[s("li",[e._v("Offer guidance to the user when creating passwords (Passphrases, Meters)")]),s("li",[e._v("Do not require periodic password changes")]),s("li",[e._v("Do not allow password hints")]),s("li",[e._v("Allow users to paste into a password field")]),s("li",[e._v("Allow user to view the password as they type")])])])],1),s("slide",[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",[e._v("Disallow weak or commonly used passwords")])]),s("ul",[s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("List of common or weak passwords that are not allowed")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("Credentials that have been leaked from a hack")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("Use a third party service")])])],1),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("p",[s("a",{attrs:{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",target:"_blank"}},[e._v("SecLists/Passwords at master · danielmiessler/SecLists · GitHub")])])])],1),s("slide",{attrs:{steps:2}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("Disallow weak or commonly used passwords")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("DISALLOWED_PASSWORDS = listToArray( "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" THIS COULD BE POPULATED FROM A DATABASE QUERY")]),e._v('\n  list = fileRead("DISALLOWED_PASSWORDS.txt"),\n  delimiters = chr(10) & chr(13)\n);\n\nfunction isAllowed(required string password) {\n\n  return !DISALLOWED_PASSWORDS.find( lcase(arguments.password) );\n}')],1)],1)]),s("br"),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[s("eg-code-block",[e._v("password1 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\n12345678 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\nyankeeswin@1\nMyPassword1 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\nyankeehotelfoxtrot\nYankee Hotel Foxtrot\np@ssw0rd "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\npassw0rdphrase\np[ssw0rdphrase\n🙈🙉🙊thisworks\n")],1)],1)])],1),s("slide",{attrs:{steps:"10"}},[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Secure password storage")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[e._v("DO NOT ROLL YOUR OWN!")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step == 3"}],staticClass:"center"},[e._v("Use a trusted library such as "),s("a",{attrs:{href:"https://www.mindrot.org/projects/jBCrypt/",target:"_blank"}},[e._v("jBCrypt")]),e._v(".")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:4==e.step,expression:"step == 4"}],staticClass:"center"},[s("h4",[e._v("Install from ForgeBox")]),s("eg-code-block",[e._v("box install bcrypt\n")])],1)]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:5==e.step,expression:"step == 5"}],staticClass:"center"},[s("h4",[e._v("BCrypt Library Usage Example:")]),s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="bcrypt" inject="BCrypt@BCrypt";')]),s("p",[e._v("or")]),s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('var bcrypt = getInstance("BCrypt@BCrypt");\n')])],1)]),s("h4",{directives:[{name:"show",rawName:"v-show",value:e.step>5&&e.step<11,expression:"step > 5 && step < 11"}],staticClass:"center"},[e._v("BCrypt Library Usage Example:")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:6==e.step||7==e.step,expression:"step == 6 || step == 7"}]},[e._v("Hash the password for storage")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:6==e.step,expression:"step == 6"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("var hash = bcrypt.hashPassword( password = rc.password );\n")])],1)]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("img",{directives:[{name:"show",rawName:"v-show",value:7==e.step,expression:"step == 7"}],staticStyle:{"max-width":"110%"},attrs:{src:"static/hash.png"}})]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.step>7&&e.step<11,expression:"step > 7 && step < 11"}]},[e._v("Check the password on login")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.step>7&&e.step<11,expression:"step > 7 && step < 11"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("if (\n  userQuery.recordCount "),s("eg-code-comment",{attrs:{active:8==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY USERNAME EXISTS")]),e._v("\n  && bcrypt.checkPassword(arguments.password,userQuery.password) "),s("eg-code-comment",{attrs:{active:9==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY PASSWORD")]),e._v('\n) {\n  sessionStorage.setVar("isLoggedIn",true);\n  sessionStorage.setVar("user",userService.get(userQuery.p_user));\n  isAuthenticated = true;\n}\nelse {\n  bcrypt.hashPassword(arguments.password) '),s("eg-code-comment",{attrs:{active:10==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" HASH PASSWORD EVEN IF ACCOUNT DOESN'T EXIST")]),e._v("\n}\n")],1)],1)])],1),s("slide",[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Password Recovery Mechanism")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 1: Verify something they know")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("This can a be the answer to a security question that was gathered during the registration process")])])])],1),s("slide",[s("h3",[e._v("Password Recovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 2: Send a token over a side-channel")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Send a randomly generated code via email, SMS or other type of multi-factor verification method")]),s("li",[e._v("Make sure the token is only valid for a short amount of time (No more than 20 minutes)")])])])],1),s("slide",[s("h3",[e._v("Password Recovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 3: Verify the token or code sent in step 2")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Have the user enter the code to verify it")]),s("li",[e._v("Once the token is verified it should be invalidated")])])])],1),s("slide",[s("h3",[e._v("Password Recovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 4: Allow the user to set a new password")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Use logging to keep audit records")])])])],1)],1)])},staticRenderFns:[]}},209:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"BrokenAuthentication"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:7}},[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[s("h2",[e._v("Broken Authentication")])]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("li",[e._v("Permits brute force or other automated attacks.")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?s("li",[e._v("Allows default or weak passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",[e._v("Uses plain text, encrypted, or weakly hashed passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?s("li",[e._v("Uses weak password recovery processes")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=6?s("li",[e._v("Has missing or ineffective multi-factor authentication")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=7?s("li",[e._v("Improper session handling")]):e._e()])],1)],1),s("slide",[s("h2",[e._v("Broken Authentication")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Secure authentication is hard to implement. There are many attack vectors available hackers can use to break it.")])])],1),s("slide",[s("div",{staticClass:"center"},[s("h2",[e._v("Questions?")]),s("a",{attrs:{href:"/"}},[e._v("Back Home")])])])],1)])},staticRenderFns:[]}},21:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},210:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"BrokenAuthentication"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:8}},[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[s("h2",[e._v("Broken Authentication")])]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2&&8!=e.step?s("li",[e._v("Permits brute force or other automated attacks.")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?s("li",[e._v("Allows default or weak passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",[e._v("Uses plain text, encrypted, or weakly hashed passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?s("li",[e._v("Uses weak password recovery processes")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=6&&8!=e.step?s("li",[e._v("Has missing or ineffective multi-factor authentication")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=7&&8!=e.step?s("li",[e._v("Improper sesion handling")]):e._e()])],1)],1),s("passwords",{attrs:{inserted:!0}}),s("slide",{attrs:{steps:5}},[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[s("h2",[e._v("Summary")])]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("li",[e._v("Encourage strong passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?s("li",[e._v("Disallowing weak or common passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",[e._v("Secure password storage")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?s("li",[e._v("Password recovery processes")]):e._e()])],1)],1),s("slide",{attrs:{steps:5}},[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[s("h2",[e._v("Whats next?")])]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("li",[e._v("Permits brute force or other automated attacks")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?s("li",[e._v("Multi-factor authentication")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",[e._v("Session handling")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?s("li",[e._v("Auditing and Logging")]):e._e()])],1)],1)],1)])},staticRenderFns:[]}},211:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"BrokenAuthentication"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:2}},[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Preventing brute force attacks")])]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("h4",[e._v("Lockout account after "),s("b",[e._v("x")]),e._v(" failed attempts within "),s("b",[e._v("y")]),e._v(" timeframe")]):e._e()]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("li",{staticClass:"sub-item"},[e._v("Most common")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("li",{staticClass:"sub-item"},[e._v("Susceptible to account DOS")]):e._e()])],1)],1),s("slide",{attrs:{steps:4}},[s("h3",[e._v("Preventing brute force attacks")]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("h4",[e._v("Increasingly delay failed login attempts")]):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step == 3"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("if (failedRequestCount > attemptThreshold) {\n  delay = failedRequestCount * 1000;\n}\n\nif (delay > 0) {\n  sleep( delay );\n}\n")])],1)]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",{staticClass:"sub-item"},[e._v("Effective but also susceptible to DOS")]):e._e()])],1)],1),s("slide",{attrs:{steps:6}},[s("h3",[e._v("Preventing brute force attacks")]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("h4",[e._v("Rate limit authentication requests")]):e._e()]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.step>=3,expression:"step >= 3"}],staticClass:"center"},[s("a",{attrs:{href:"https://www.nginx.com/blog/rate-limiting-nginx/",target:"_blank"}},[e._v("NGINX")])])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.step>=3,expression:"step >= 3"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s; "),s("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" Limit by IP at 10 requests/second")]),e._v("\n\nlocation /login/ { "),s("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" Apply limit to /login ")]),e._v("\n    limit_req zone=mylimit burst=20 nodelay; "),s("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" More than 20 requests within 10 seconds will be rejected ")]),e._v("\n\n    proxy_pass http://my_upstream;\n}\n")],1)],1)])],1),s("slide",{attrs:{steps:6}},[s("h3",[e._v("Preventing brute force attacks")]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?s("h4",[e._v("Use "),s("a",{attrs:{href:"https://www.google.com/recaptcha/",target:"_blank"}},[e._v("reCaptcha")]),e._v(" to prevent automated submissions")]):e._e()]),s("eg-transition",{attrs:{enter:"zoomIn"}},[e.step>=3?s("h3",{staticClass:"center"},[e._v("DEMO TIME")]):e._e()])],1),s("slide",[s("div",{staticClass:"center"},[s("h2",[s("a",{attrs:{href:"/"}},[e._v("Back Home")])])])])],1)])},staticRenderFns:[]}},212:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"eg-theme-agrume",attrs:{id:"BrokenAuthentication"}},[s("div",{staticClass:"eg-slideshow"},[s("slide",{attrs:{steps:8}},[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[s("h2",[e._v("Broken Authentication")])]),s("ul",[s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2&&8!=e.step?s("li",[e._v("Permits brute force or other automated attacks.")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?s("li",[e._v("Allows default or weak passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?s("li",[e._v("Uses plain text, encrypted, or weakly hashed passwords")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?s("li",[e._v("Uses weak password recovery processes")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=6&&8!=e.step?s("li",[e._v("Has missing or ineffective multi-factor authentication")]):e._e()]),s("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=7&&8!=e.step?s("li",[e._v("Improper sesion handling")]):e._e()])],1)],1),s("slide",{attrs:{enter:"bounceInRight"}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("Password Complexity Requirements")]),s("ul",[s("li",[e._v("Must be at least 10 characters, allowing up to 128")]),s("li",[e._v("Must meet 3 of 4 complexity rules"),s("ul",[s("li",{staticClass:"sub-item"},[e._v("at least 1 uppercase character (A-Z)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 lowercase character (a-z)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 digit (0-9)")]),s("li",{staticClass:"sub-item"},[e._v("at least 1 special character ("),s("a",{attrs:{href:"https://www.owasp.org/index.php/Password_special_characters",target:"_blank"}},[e._v("punctuation")]),e._v(") — do not forget to treat space as special characters too")])])])])]),s("slide",{attrs:{steps:8}},[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  var isValid = false;\n  var specialCharacterRegEx = "[ ""\'\\(\\)\\+,-\\./\\:\\;<=>\\?\\[\\]\\\\_`\\{\\}\\|~!@##\\$%\\^&\\*]";\n\n  if (\n    len(arguments.password) >= 10 '),s("eg-code-comment",{attrs:{active:2===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT LEAST 10 CHARACTERS")]),e._v("\n    && len(arguments.password) < 128 ) { "),s("eg-code-comment",{attrs:{active:3===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT MOST 128 CHARACTERS")]),e._v('\n\n    var complexityCount = (\n        ( reFind("[a-z]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:4===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR LOWERCASE")]),e._v('\n      + ( reFind("[A-Z]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:5===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR UPPERCASE")]),e._v('\n      + ( reFind("[0-9]",arguments.password) ? 1 : 0 ) '),s("eg-code-comment",{attrs:{active:6===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR DIGITS")]),e._v("\n      + ( reFind(specialCharacterRegEx,arguments.password) ? 1 : 0 ) "),s("eg-code-comment",{attrs:{active:7===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR SPECIAL CHARACTERS")]),e._v("\n    );\n\n    isValid = complexityCount >= 3; "),s("eg-code-comment",{attrs:{active:8===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" MUST HAVE AT LEAST 3 of 4")]),e._v("\n\n  }\n\n  return isValid;\n}\n")],1)],1)],1),s("slide",[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("img",{style:{height:"16em"},attrs:{src:"https://imgs.xkcd.com/comics/password_strength.png"}}),s("p",[e._v("xkcd.com")])])])],1),s("slide",[s("h3",[e._v("Password Strength")]),s("h4",{staticClass:"center"},[e._v("New NIST Password Guidelines")]),s("eg-transition",{attrs:{enter:"bounceInLeft"}},[s("ul",[s("li",[e._v("Must be at least 8 characters, allowing up to 64")]),s("li",[e._v("The maximum should be at least 64 characters")]),s("li",[e._v("Allow all ASCII and UNICODE characters, including emoji")]),s("li",[e._v("Eliminate any other complexity requirements")])])])],1),s("slide",[s("h3",[e._v("Password Strength")]),s("h4",{staticClass:"center"},[e._v("New NIST Password Guidelines")]),s("eg-transition",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  return\n    len(arguments.password) >= 8\n    && len(arguments.password) < 128\n}\n\nvalidatePassword("🙈🙉🙊thisworks"); '),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Valid")])],1)],1)],1),s("slide",{attrs:{enter:"slideInLeft",leave:"slideOutRight"}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("New NIST Password Guidelines Cont...")]),s("ul",[s("li",[e._v("Offer guidance to the user when creating passwords (Passphrases, Meters)")]),s("li",[e._v("Do not require periodic password changes")]),s("li",[e._v("Do not allow password hints")]),s("li",[e._v("Allow users to paste into a password field")]),s("li",[e._v("Allow user to view the password as they type")])])]),s("slide",{attrs:{enter:"slideInLeft",leave:"slideOutRight"}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("New NIST Password Guidelines Cont...")])]),s("slide",[s("h3",[e._v("Password Strength")]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",[e._v("Disallow weak or commonly used passwords")])]),s("ul",[s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("List of common or weak passwords that are not allowed")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("Credentials that have been leaked from a hack")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("li",[e._v("Use a third party service")])])],1),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("p",[s("a",{attrs:{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",target:"_blank"}},[e._v("SecLists/Passwords at master · danielmiessler/SecLists · GitHub")])])])],1),s("slide",{attrs:{steps:2}},[s("h3",[e._v("Password Strength")]),s("h4",[e._v("Disallow weak or commonly used passwords")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("DISALLOWED_PASSWORDS = listToArray( "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" THIS COULD BE POPULATED FROM A DATABASE QUERY")]),e._v('\n  list = fileRead("DISALLOWED_PASSWORDS.txt"),\n  delimiters = chr(10) & chr(13)\n);\n\nfunction isAllowed(required string password) {\n\n  return !DISALLOWED_PASSWORDS.find( lcase(arguments.password) );\n}')],1)],1)]),s("br"),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[s("eg-code-block",[e._v("password1 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\n12345678 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\nyankeeswin@1\nMyPassword1 "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\nyankeehotelfoxtrot\nYankee Hotel Foxtrot\np@ssw0rd "),s("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Not Allowed")]),e._v("\npassw0rdphrase\np[ssw0rdphrase\n🙈🙉🙊thisworks\n")],1)],1)])],1),s("slide",{attrs:{steps:"10"}},[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Secure password storage")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[e._v("DO NOT ROLL YOUR OWN!")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("h4",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step == 3"}],staticClass:"center"},[e._v("Use a trusted library such as "),s("a",{attrs:{href:"https://www.mindrot.org/projects/jBCrypt/",target:"_blank"}},[e._v("jBCrypt")]),e._v(".")])]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:4==e.step,expression:"step == 4"}],staticClass:"center"},[s("h4",[e._v("Install from ForgeBox")]),s("eg-code-block",[e._v("box install bcrypt\n")])],1)]),s("eg-transition",{attrs:{enter:"slideInRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:5==e.step,expression:"step == 5"}],staticClass:"center"},[s("h4",[e._v("BCrypt Library Usage Example:")]),s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="bcrypt" inject="BCrypt@BCrypt";')]),s("p",[e._v("or")]),s("eg-code-block",{attrs:{lang:"javascript"}},[e._v('var bcrypt = getInstance("BCrypt@BCrypt");\n')])],1)]),s("h4",{directives:[{name:"show",rawName:"v-show",value:e.step>5&&e.step<11,expression:"step > 5 && step < 11"}],staticClass:"center"},[e._v("BCrypt Library Usage Example:")]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:6==e.step||7==e.step,expression:"step == 6 || step == 7"}]},[e._v("Hash the password for storage")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:6==e.step,expression:"step == 6"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("var hash = bcrypt.hashPassword(\n  password = rc.password\n  workFactor = 12\n);\n")])],1)]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("img",{directives:[{name:"show",rawName:"v-show",value:7==e.step,expression:"step == 7"}],staticStyle:{"max-width":"110%"},attrs:{src:"static/hash.png"}})]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.step>7&&e.step<11,expression:"step > 7 && step < 11"}]},[e._v("Check the password on login")])]),s("eg-transition",{attrs:{enter:"fadeIn"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.step>7&&e.step<11,expression:"step > 7 && step < 11"}],staticClass:"center"},[s("eg-code-block",{attrs:{lang:"javascript"}},[e._v("if (\n  userQuery.recordCount "),s("eg-code-comment",{attrs:{active:8==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY USERNAME EXISTS")]),e._v("\n  && bcrypt.checkPassword(arguments.password,userQuery.password) "),s("eg-code-comment",{attrs:{active:9==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY PASSWORD")]),e._v('\n) {\n  sessionStorage.setVar("isLoggedIn",true);\n  sessionStorage.setVar("user",userService.get(userQuery.p_user));\n  isAuthenticated = true;\n}\nelse {\n  hashPassword(arguments.password) '),s("eg-code-comment",{attrs:{active:10==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" HASH PASSWORD EVEN IF ACCOUNT DOESN'T EXIST")]),e._v("\n}\n")],1)],1)])],1),s("slide",[s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h3",[e._v("Password\tRecovery Mechanism")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 1: Verify something they know")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("This can a be the answer to a security question that was gathered during the registration process")])])])],1),s("slide",[s("h3",[e._v("Password\tRecovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 2: Send a token over a side-channel")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Send a randomly generated code via email, SMS or other type of multi-factor verification method")]),s("li",[e._v("Make sure the token is only valid for a short amount of time (No more than 20 minutes)")])])])],1),s("slide",[s("h3",[e._v("Password\tRecovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 3: Verify the token or code sent in step 2")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Have the user enter the code to verify it")]),s("li",[e._v("Once the token is verified it should be invalidated")])])])],1),s("slide",[s("h3",[e._v("Password\tRecovery Mechanism")]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("h4",[e._v("Step 4: Allow the user to set a new password")])]),s("eg-transition",{attrs:{enter:"lightSpeedIn"}},[s("ul",[s("li",[e._v("Use logging to keep audit records")])])])],1),s("slide",[s("div",{staticClass:"center"},[s("h2",[e._v("Questions?")])])])],1)])},staticRenderFns:[]}},213:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},staticRenderFns:[]}},214:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"frontpage"},[s("div",{staticClass:"content"},[e._m(0),s("div",{staticClass:"logo"}),s("ol",[s("li",[s("router-link",{attrs:{to:"/injection"},nativeOn:{click:function(t){e.click(t)}}},[e._v("Injection")])],1),s("li",[s("router-link",{attrs:{to:"/authentication"},nativeOn:{click:function(t){e.click(t)}}},[e._v("Broken Authentication")])],1)])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("h1",{staticStyle:{"margin-top":"50px"}},[s("span",[e._v("SECURE CFML:")]),s("span",{staticClass:"grey"},[e._v("OWASP TOP 10")])])}]}},22:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},23:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(1),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default={mixins:[a.default.slideshow]}},24:function(e,t){},25:function(e,t){},26:function(e,t){},27:function(e,t){},28:function(e,t){},29:function(e,t){},3:function(e,t){},30:function(e,t){},31:function(e,t){},32:function(e,t){},4:function(e,t,s){s(31);var n=s(0)(s(15),s(213),null,null);e.exports=n.exports},5:function(e,t,s){s(32);var n=s(0)(s(16),s(214),"data-v-9d3aa8ce",null);e.exports=n.exports},6:function(e,t,s){s(28);var n=s(0)(s(17),s(210),null,null);e.exports=n.exports},7:function(e,t,s){s(24);var n=s(0)(s(18),s(206),null,null);e.exports=n.exports},8:function(e,t,s){s(30);var n=s(0)(s(19),s(212),null,null);e.exports=n.exports},9:function(e,t,s){s(27);var n=s(0)(s(20),s(209),null,null);e.exports=n.exports}},[14]);