webpackJsonp([1],{11:function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var a=n(10),r=s(a),i=n(9),o=s(i),c=n(4),l=s(c),d=n(5),u=s(d),v=n(1),p=s(v);n(3);var g=n(7),h=s(g),_=n(6),m=s(_),f=n(8),I=s(f);r.default.use(p.default),r.default.use(o.default);var b=[];b.push({path:"/injection",component:h.default}),b.push({path:"/authentication",component:m.default}),b.push({path:"/mfa",component:I.default}),b.push({path:"*",component:u.default}),b.push({path:"/",name:"Home",component:u.default});var w=new o.default({routes:b});new r.default({el:"#app",router:w,template:"<App/>",components:{App:l.default}})},12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={list:[]}},13:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(12),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={data:function(){return{slideshows:a.default.list}},mounted:function(){document.currentSlide={}},methods:{click:function(e){e.stopPropagation()}}}},15:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={mixins:[a.default.slideshow]}},16:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={mixins:[a.default.slideshow]}},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={mixins:[a.default.slideshow]}},18:function(e,t){},19:function(e,t){},195:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"eg-theme-agrume",attrs:{id:"Injection"}},[n("div",{staticClass:"eg-slideshow"},[n("slide",{attrs:{steps:3,enter:"fadeIn",leave:"bounceOutLeft"}},[n("h3",[e._v("Injection ")]),n("p",{staticClass:"center"},[e._v("An attacker uses input parameters to inject malicious code or commands to a vulnerable application")]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=2?n("p",[n("b",[e._v("SQL Injection")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=3?n("p",[n("b",[e._v("ORM Injection")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?n("p",[n("b",[e._v("LDAP Injection")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=3?n("p",[n("b",[e._v("XPath Injection")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?n("p",[n("b",[e._v("NoSQL Injection")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?n("p",[n("b",[e._v("OS Command Injection ")])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInLeft",leave:"bounceOutLeft"}},[e.step>=3?n("p",[n("b",[e._v("Code Injection")]),e._v(".")]):e._e()])],1)]),n("slide",{attrs:{enter:"bounceInRight",leave:"bounceOutDown"}},[n("h3",[e._v("SQL Injection")]),n("p",[e._v("Common weakness of database driven web applications where SQL code is injected as an input parameter")])]),n("slide",{attrs:{steps:2}},[n("h3",[e._v("SQL Injection")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('userQuery = queryExecute("\n  select \n    p_user,\n    first_name,\n    last_name,\n    email,\n    phone,\n  from users\n  where p_user = #url.userID#\n");')])],1),n("eg-transition",{attrs:{enter:"bounceInLeft"}},[2==e.step?n("div",[2==e.step?n("h4",[e._v("Examples")]):e._e(),n("ul",[2==e.step?n("li",[n("code",[e._v("?userid=1 or 1=1")])]):e._e(),2==e.step?n("li",[n("code",[e._v("?userid=1;delete from clients`")])]):e._e()])]):e._e()])],1),n("slide",{attrs:{steps:2}},[n("h3",[e._v("SQL Injection")]),n("p",[e._v("Use query parameters to prevent these attacks.")]),n("eg-transition",{attrs:{enter:"bounceInDown"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('userQuery = queryExecute("\n  select \n    p_user,\n    first_name,\n    last_name,\n    email,\n    phone,\n  from users\n  where p_user = :userID\n",{ userID = url.userid });')]),n("p",[e._v("This will throw an error if malicious parameters are passed in.")])],1),n("eg-transition",{attrs:{enter:"zoomInX",leave:"zoomOutX"}},[2==e.step?n("p",[e._v("This will throw an error if malicious parameters are passed in.")]):e._e()])],1),n("slide",[n("h1",[e._v("SQL Injection Demo")])]),n("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("ORM")]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"bounceInRight"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('ORMExecuteQuery("\n  from Orders \n  where OrderID=:orderid \n  and ProductID=:productid\n",{\n    orderid=1, \n    productid=901\n}, true)')])],1)],1),n("eg-transition",{attrs:{enter:"bounceInRight"}},[n("p",[e._v("ORM is vulnerable as well. Be sure to use sql parameters when filtering and searching in ORM as well.")])])],1),n("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("LDAP Injection")]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"fadeIn"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('departmentId = "Human Resources <CTO>";\nsearchStart = "ou=" & encodeForDN(departmentId) & ",dc=uconn,dc=edu";\ncfldap(  \n    server = "ldap.uconn.edu", \n    action = "query",\n    name = "results" ,\n    start = "#searchStart#", \n    filter = "cn=Robert Jones" ,\n    attributes = "cn,description,o,title,mail,telephonenumber", \n    sort = "cn ASC");')])],1)],1),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Use "),n("code",[e._v("encodeForDN()")]),e._v(" for any parameters used in a cfldap query.")])])],1),n("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("XML/Xpath Injection")]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"fadeIn"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('encodeForXPath("\'or 1=1",false)')])],1)],1),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Use "),n("code",[e._v("encodeForXPath()")]),e._v(" for any parameters used in a XML queries.")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Expected Result: "),n("code",[e._v("&#x27;or 1&#x3d;1")])])])],1),n("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("Operating System (OS) Command Injection")]),n("p",{staticClass:"center"},[e._v("An type of injection where software executes OS commands and user can inject other commands as input")])]),n("slide",[n("h3",[e._v("Operating System (OS) Command Injection")]),n("eg-transition",{attrs:{enter:"bounceInLeft"}},[n("div",[n("h4",[e._v("Example")]),n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('cfexecute(\n  name="c:\\windows\\system32\\cmd.exe",\n  arguments="/c ping #url.host#",\n  variable="output",\n  timeout="10"\n);')]),n("p",[n("code",[e._v("?host=contactmanager %26 whoami")])])],1)])],1),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Operating System (OS) Command Injection")]),n("h4",[e._v("Prevention")]),n("ul",[e.step>=1?n("li",[e._v("Avoid using OS commands and use native libraries instead")]):e._e(),e.step>=2?n("li",[e._v("Use ESAPI "),n("code",[e._v("encodeForOS()")]),e._v(" method to escape special characters")]):e._e(),e.step>=3?n("li",[e._v("Use strict validation")]):e._e()])]),n("slide",[n("h3",[e._v("Operating System (OS) Command Injection")]),n("h1",{staticClass:"center"},[e._v("DEMO")])]),n("slide",{attrs:{steps:3,enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("Code Injection")]),n("p",{staticClass:"center"},[e._v("An attacker can inject language specific code that is then executed by the language interpreter.")]),e.step>=2?n("h4",[e._v("Example")]):e._e(),n("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=2?n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('<cfset vv.key_list = evaluate("key_list_" & url.key_list)>')]):e._e()],1),n("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=3?n("h4",[e._v("Malicious URL String")]):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[e.step>=3?n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('?key_list_=zzz&key_list= eq \'abc\' or setVariable("session.login_user_name", "Super User") eq "Super Administrator" and setVariable("session.login_role", "Administrator") eq "Administrator"\n')]):e._e()],1)],1),n("slide",{attrs:{enter:"bounceInRight",leave:"fadeOut"}},[n("h3",[e._v("Code Injection")]),n("h4",{staticClass:"center"},[e._v("Prevention")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Avoid using "),n("code",[e._v("evaluate()")]),e._v(" or "),n("code",[e._v("iif()")]),e._v(". If you absolutly need it then make sure the input is validated first.")])])],1),n("slide",{attrs:{steps:4,enter:"bounceInRight"}},[n("h3",[e._v("Summary: Injection Prevention")]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=2?n("p",[n("b",[e._v("Perform proper input validation")]),n("ul",[n("li",[e._v("Whitelist validation")]),n("li",[e._v("Use functions such as "),n("code",[e._v("isValid()")]),e._v(" to validate user input")])])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=3?n("p",[n("b",[e._v("Use a safe API")]),e._v(" "),n("ul",[n("li",[e._v("SQL Paramaters")]),n("li",[e._v("ESAPI Built in CF Functions: "),n("a",{attrs:{href:"https://cfdocs.org/encodefor",target:"_blank"}},[e._v("encodeFor*")])])])]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutRight"}},[e.step>=4?n("p",[n("b",[e._v("Contextually escape user data")]),e._v(" "),n("ul",[n("li",[e._v("If library is not available use "),n("code",[e._v("replace()")]),e._v(" or "),n("code",[e._v("reReplace()")]),e._v(" to remove uwanted characters.")])])]):e._e()])],1)],1)])},staticRenderFns:[]}},196:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"eg-theme-agrume",attrs:{id:"BrokenAuthentication"}},[n("div",{staticClass:"eg-slideshow"},[n("slide",{attrs:{steps:7}},[n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[n("h2",[e._v("Broken Authentication ")])]),n("ul",[n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("li",[e._v("Permits brute force or other automated attacks.")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=3?n("li",[e._v("Allows default or weak passwords")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?n("li",[e._v("Uses plain text, encrypted, or weakly hashed passwords")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=5?n("li",[e._v("Uses weak password recovery processes")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=6?n("li",[e._v("Has missing or ineffective multi-factor authentication")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=7?n("li",[e._v("Improper session handling")]):e._e()])],1)],1),n("slide",[n("h2",[e._v("Broken Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",[e._v("Secure authentication is hard to implement. There are many attack vectors available hackers can use to break it.")])])],1),n("slide",{attrs:{steps:4}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h3",[e._v("Password Length & Complexity")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",[n("a",{attrs:{href:"https://www.owasp.org/index.php/Authentication_Cheat_Sheet#Implement_Proper_Password_Strength_Controls",target:"_blank"}},[e._v("OWASP Authentication Cheat Sheet")]),e._v(" Guidelines")])]),e.step>=2&&e.step<6?n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?n("li",[e._v("Must be at least 10 characters, allowing up to 128")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[e._v("Must meet 3 of 4 complexity rules"),n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",{staticClass:"sub-item"},[e._v("at least 1 uppercase character (A-Z)")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",{staticClass:"sub-item"},[e._v("at least 1 lowercase character (a-z)")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",{staticClass:"sub-item"},[e._v("at least 1 digit (0-9)")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",{staticClass:"sub-item"},[e._v("at least 1 special character ("),n("a",{attrs:{href:"https://www.owasp.org/index.php/Password_special_characters",target:"_blank"}},[e._v("punctuation")]),e._v(") — do not forget to treat space as special characters too")]):e._e()])],1)]):e._e()])],1):e._e()],1),n("slide",{attrs:{steps:8}},[n("h3",[e._v("Password Length & Complexity")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  var isValid = false;\n  var specialCharacterRegEx = "[ ""\'\\(\\)\\+,-\\./\\:\\;<=>\\?\\[\\]\\\\_`\\{\\}\\|~!@##\\$%\\^&\\*]";\n\n  if (\n    len(arguments.password) >= 10 '),n("eg-code-comment",{attrs:{active:2===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT LEAST 10 CHARACTERS")]),e._v("\n    && len(arguments.password) < 128 ) { "),n("eg-code-comment",{attrs:{active:3===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" AT MOST 128 CHARACTERS")]),e._v('\n\n    var complexityCount = (\n        ( reFind("[a-z]",arguments.password) ? 1 : 0 ) '),n("eg-code-comment",{attrs:{active:4===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR LOWERCASE")]),e._v('\n      + ( reFind("[A-Z]",arguments.password) ? 1 : 0 ) '),n("eg-code-comment",{attrs:{active:5===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR UPPERCASE")]),e._v('\n      + ( reFind("[0-9]",arguments.password) ? 1 : 0 ) '),n("eg-code-comment",{attrs:{active:6===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR DIGITS")]),e._v("\n      + ( reFind(specialCharacterRegEx,arguments.password) ? 1 : 0 ) "),n("eg-code-comment",{attrs:{active:7===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK FOR SPECIAL CHARACTERS")]),e._v("\n    );\n\n    isValid = complexityCount >= 3; "),n("eg-code-comment",{attrs:{active:8===e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" MUST HAVE AT LEAST 3 of 4")]),e._v("\n\n  }\n        \n  return isValid;\n}\n")],1)],1)],1),n("slide",[n("h3",[e._v("Password Length & Complexity")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("img",{style:{height:"16em"},attrs:{src:"https://imgs.xkcd.com/comics/password_strength.png"}}),n("p",[e._v("xkcd.com")])])])],1),n("slide",{attrs:{steps:7}},[n("h3",[e._v("Password Length & Complexity")]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[n("h4",{staticClass:"center"},[n("a",{attrs:{href:"https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret",target:"_blank"}},[e._v("New NIST Password Guidelines")])])]),e.step>=3?n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[e._v("Must be at least 8 characters, allowing up to 64")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=4?n("li",[e._v("The maximum should be at least 64 characters")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=5?n("li",[e._v("Allow all ASCII and UNICODE characters, including emoji")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=6?n("li",[e._v("Eliminate any other complexity requirements")]):e._e()])],1):e._e()],1),n("slide",[n("h3",[e._v("Password Length & Complexity")]),n("h4",{staticClass:"center"},[n("a",{attrs:{href:"https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret",target:"_blank"}},[e._v("New NIST Password Guidelines")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('function validatePassword(required string password) {\n\n  return \n    len(arguments.password) >= 8 \n    && len(arguments.password) < 128\n}\n\nvalidatePassword("🙈🙉🙊thisworks"); '),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" Valid")])],1)],1)],1),n("slide",{attrs:{steps:7}},[n("h3",[e._v("New NIST Password Guidelines (CONT)")]),e.step>=2?n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?n("li",[e._v("Offer guidance to the user when creating passwords (Passphrases, Meters)")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[e._v("Do not require periodic password changes")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=5?n("li",[e._v("Do not allow password hints")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=6?n("li",[e._v("Allow users to paste into a password field")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=7?n("li",[e._v("Allow user to view the password as they type")]):e._e()])],1):e._e()]),n("slide",{attrs:{steps:5}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h3",[e._v("Implement Password Blacklist")])]),n("ul",[n("eg-transition",{attrs:{enter:"slideInRight"}},[n("li",{directives:[{name:"show",rawName:"v-show",value:e.step>=2,expression:"step >= 2"}]},[e._v("Include common or weak passwords")])]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("li",{directives:[{name:"show",rawName:"v-show",value:e.step>=3,expression:"step >= 3"}]},[e._v("Include passwords from credentials that have been leaked from a hack")])]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("li",{directives:[{name:"show",rawName:"v-show",value:e.step>=4,expression:"step >= 4"}]},[e._v("Use a third party service")])])],1),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.step>=5,expression:"step >= 5"}]},[n("a",{attrs:{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",target:"_blank"}},[e._v("SecLists/Passwords at master · danielmiessler/SecLists · GitHub")])])])],1),n("slide",{attrs:{steps:2}},[n("h3",[e._v("Implement Password Blacklist")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("PASSWORD_BLACKLIST = listToArray( "),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" THIS COULD BE POPULATED FROM A DATABASE QUERY")]),e._v('\n  list = fileRead("blacklist.txt"), \n  delimiters = chr(10) & chr(13) \n); \n\nfunction isBlacklisted(required string password) {\n\n  return PASSWORD_BLACKLIST.find( lcase(arguments.password) );\n}')],1)],1)]),n("br"),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[n("eg-code-block",[e._v("password1 "),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" BLACKLISTED")]),e._v(" \n12345678 "),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" BLACKLISTED")]),e._v(" \nyankeeswin@1 \nMyPassword1 "),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" BLACKLISTED")]),e._v(" \nyankeehotelfoxtrot \nYankee Hotel Foxtrot \np@ssw0rd "),n("eg-code-comment",{attrs:{enter:"fadeIn",leave:"fadeOut"}},[e._v(" BLACKLISTED")]),e._v(" \npassw0rdphrase \np[ssw0rdphrase \n🙈🙉🙊thisworks\n")],1)],1)])],1),n("slide",{attrs:{steps:"15"}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h3",[e._v("Secure password storage")])]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("h4",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step == 2"}],staticClass:"center"},[e._v("DO NOT ROLL YOUR OWN!")])]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("h4",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step == 3"}],staticClass:"center"},[e._v("Use a trusted library such as "),n("a",{attrs:{href:"https://www.mindrot.org/projects/jBCrypt/",target:"_blank"}},[e._v("jBCrypt")]),e._v(".")])]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:4==e.step,expression:"step == 4"}],staticClass:"center"},[n("h4",[e._v("Install from ForgeBox")]),n("eg-code-block",[e._v("box install bcrypt \n")])],1)]),n("eg-transition",{attrs:{enter:"slideInRight"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:5==e.step,expression:"step == 5"}],staticClass:"center"},[n("h4",[e._v("Inject via Property or variable")]),n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="bcrypt" inject="BCrypt@BCrypt";')]),n("br"),n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('var bcrypt = getInstance("BCrypt@BCrypt");\n')])],1)]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.step>5&&e.step<9,expression:"step > 5 && step < 9"}],staticClass:"center"},[e._v("User Registration Example:")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.step>5&&e.step<9,expression:"step > 5 && step < 9"}],staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("var user = userService.get(); \nuser.setFirstName(rc.firstName);\nuser.setLastName(rc.lastName);\nuser.setUsername(rc.username);\nvar hash = bcrypt.hashPassword( "),n("eg-code-comment",{attrs:{active:7==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" HASH THE USER'S PASSWORD")]),e._v(" \n  password = rc.password\n  workFactor = 12\n);\nuser.setPassword(hash);\nuserService.save(user); "),n("eg-code-comment",{attrs:{active:8==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SAVE THE USER RECORD WITH HASHED PASSWORD")])],1)],1)]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("img",{directives:[{name:"show",rawName:"v-show",value:9==e.step,expression:"step == 9"}],staticStyle:{"max-width":"110%"},attrs:{src:"static/hash.png"}})]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.step>9&&e.step<15,expression:"step > 9 && step < 15"}],staticClass:"center"},[e._v("Authentication Example:")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.step>9&&e.step<15,expression:"step > 9 && step < 15"}],staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("var isAuthenticated = false;\n\nvar q = queryExecute( "),n("eg-code-comment",{attrs:{active:11==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" QUERY DATABASE FOR USER RECORD")]),e._v(' \n  "\n    SELECT p_user, password\n    FROM [user]\n    WHERE\n      username = :username\n\n  ",\n  {\n    username = arguments.username\n  }\n);\n\nif (\n  q.recordCount '),n("eg-code-comment",{attrs:{active:12==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY USERNAME")]),e._v("\n  && bcrypt.checkPassword(arguments.password,q.password) "),n("eg-code-comment",{attrs:{active:13==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY PASSWORD")]),e._v(' \n) {     \n  sessionStorage.setVar("isLoggedIn",true);\n  sessionStorage.setVar("user",userService.get(q.p_user));\n  isAuthenticated = true;\n}\nelse {\n  hashPassword(arguments.password) '),n("eg-code-comment",{attrs:{active:14==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" HASH PASSWORD EVEN IF ACCOUNT DOESN'T EXIST")]),e._v(" \n}\n")],1)],1)])],1),n("slide",{attrs:{steps:2}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h3",[e._v("Preventing brute force attacks")])]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("h4",[e._v("Lockout account after "),n("b",[e._v("x")]),e._v(" failed attempts within "),n("b",[e._v("y")]),e._v(" timeframe")]):e._e()]),n("ul",[n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("li",{staticClass:"sub-item"},[e._v("Most common")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("li",{staticClass:"sub-item"},[e._v("Susceptible to account DOS")]):e._e()])],1)],1),n("slide",{attrs:{steps:4}},[n("h3",[e._v("Preventing brute force attacks")]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("h4",[e._v("Increasingly delay failed login attempts")]):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step == 3"}],staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("if (failedRequestCount > attemptThreshold) {\n  delay = failedRequestCount * 1000;\n}\n\nif (delay > 0) {\n  sleep( delay );\n}\n")])],1)]),n("ul",[n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=4?n("li",{staticClass:"sub-item"},[e._v("Effective but also susceptible to DOS")]):e._e()])],1)],1),n("slide",{attrs:{steps:6}},[n("h3",[e._v("Preventing brute force attacks")]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("h4",[e._v("Rate limit authentication requests")]):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.step>=3,expression:"step >= 3"}],staticClass:"center"},[n("a",{attrs:{href:"https://www.nginx.com/blog/rate-limiting-nginx/",target:"_blank"}},[e._v("NGINX")])])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.step>=3,expression:"step >= 3"}],staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s; "),n("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" Limit by IP at 10 requests/second")]),e._v("\n\nlocation /login/ { "),n("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" Apply limit to /login ")]),e._v("\n    limit_req zone=mylimit burst=20 nodelay; "),n("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" More than 20 requests within 10 seconds will be rejected ")]),e._v("\n \n    proxy_pass http://my_upstream;\n}\n")],1)],1)])],1),n("slide",{attrs:{steps:6}},[n("h3",[e._v("Preventing brute force attacks")]),n("eg-transition",{attrs:{enter:"bounceInRight",leave:"bounceOutLeft"}},[e.step>=2?n("h4",[e._v("Use "),n("a",{attrs:{href:"https://www.google.com/recaptcha/",target:"_blank"}},[e._v("reCaptcha")]),e._v(" to prevent automated submissions")]):e._e()]),n("eg-transition",{attrs:{enter:"zoomIn"}},[e.step>=3?n("h3",{staticClass:"center"},[e._v("DEMO TIME")]):e._e()])],1)],1)])},staticRenderFns:[]}},197:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"eg-theme-agrume",attrs:{id:"MFA"}},[n("div",{staticClass:"eg-slideshow"},[n("slide",{attrs:{steps:2}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h2",[e._v("Multi-Factor Authentication")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[2==e.step?n("h5",{staticClass:"center"},[e._v("Use 2 or more authentication factors to prove the identity of a user.")]):e._e()])],1),n("slide",{attrs:{steps:3}},[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h3",[e._v("Multi-Factor Authentication")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[3==e.step?n("h5",{staticClass:"center"},[e._v("What are the factors?")]):e._e()])],1),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",{staticClass:"center"},[e._v("Something you know")])]),n("br"),n("eg-transition",{attrs:{enter:"bounceInRight"}},[2==e.step?n("h5",{staticClass:"center"},[e._v("Password")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[3==e.step?n("h5",{staticClass:"center"},[e._v("PIN")]):e._e()])],1),n("slide",{attrs:{steps:5}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",{staticClass:"center"},[e._v("Something you have")])]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[2==e.step?n("h5",{staticClass:"center"},[e._v("Physical Key")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[3==e.step?n("h5",{staticClass:"center"},[e._v("Debit Card")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[4==e.step?n("h5",{staticClass:"center"},[e._v("Hardware Tokens (RSA SecureID, SmartCard, USB Tokens, etc.)")]):e._e()]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"bounceInRight"}},[4==e.step?n("img",{attrs:{src:"https://qph.fs.quoracdn.net/main-qimg-a0339042588d0aef8a825fc351adf239"}}):e._e()])],1),n("eg-transition",{attrs:{enter:"bounceInRight"}},[5==e.step?n("h5",{staticClass:"center"},[e._v("Software Tokens (Mobile Phone)")]):e._e()]),n("div",{staticClass:"center"},[n("eg-transition",{attrs:{enter:"bounceInRight"}},[5==e.step?n("img",{staticClass:"center",attrs:{height:"400px",src:"https://lh3.googleusercontent.com/SClWEmbk7QxxuKiWshok2T45vAwEQYCduisnnGORqrha7KfpQsvFZa0xac_jyj_tE9Mn=w720-h310"}}):e._e()])],1)],1),n("slide",{attrs:{steps:6}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",{staticClass:"center"},[e._v("Something you are")])]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=2?n("h5",[e._v("Biometrics")]):e._e()]),n("ul",[n("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=3?n("li",[e._v("Fingerprints")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=4?n("li",[e._v("Voice recognition")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=5?n("li",[e._v("Face recognition")]):e._e()]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[e.step>=6?n("li",[e._v("Iris scan")]):e._e()])],1)],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[n("h4",{staticClass:"center"},[e._v("Two-Factor Authentication")])]),n("eg-transition",{attrs:{enter:"bounceInRight"}},[n("h5",{staticClass:"center"},[e._v("Username/Password + Software Token (Mobile Phone)")])])],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",{staticClass:"center"},[e._v("Software Token (Mobile Phone)")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h5",{staticClass:"center"},[n("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm",target:"_blank"}},[e._v("Time-based One-time Password algorithm (TOTP)")])])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("p",{staticClass:"center"},[e._v("Algorithm to generate one-time passwords for use with authentication. Generated at time intervals (Typically 30 seconds) ")])])],1),n("slide",{attrs:{steps:4}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",[e._v("Mobile Apps")])]),n("ul",[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=2?n("li",[n("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_US",target:"_blank"}},[e._v("Google Authenticator")])]):e._e()]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?n("li",[n("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.authy.authy",target:"_blank"}},[e._v("Authy")])]):e._e()]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=4?n("li",[n("a",{attrs:{href:"https://play.google.com/store/search?q=2+factor+authentication&c=apps",target:"_blank"}},[e._v("Many Others")])]):e._e()])],1)],1),n("slide",{attrs:{steps:4}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h4",[e._v("Server Verification")])]),n("ul",[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=2?n("li",[n("a",{attrs:{href:"https://github.com/wstrange/GoogleAuth",target:"_blank"}},[e._v("wstrange/GoogleAuth")])]):e._e()]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?n("li",[n("a",{attrs:{href:"https://github.com/marcins/cf-google-authenticator",target:"_blank"}},[e._v("marcins/cf-google-authenticator")]),n("ul",[n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[e.step>=3?n("li",{staticClass:"sub-item"},[n("a",{attrs:{href:"http://junkheap.net/blog/2013/05/30/implementing-google-authenticator-support-in-coldfusion/",target:"_blank"}},[e._v("Implementing Google Authenticator Support in ColdFusion")])]):e._e()])],1)]):e._e()])],1)],1),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("SQL")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"sql"}},[e._v("ALTER TABLE [user] ADD two_factor_auth_enabled bit;"),n("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD FLAG TO DETERMINE IF USER HAS 2FA ENABLED")]),e._v(" \nALTER TABLE [user] ADD two_factor_auth_key nvarchar(50);"),n("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD FIELD TO STORE SHARED KEY")])],1)],1)])],1),n("slide",{attrs:{steps:1}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("User.cfc")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Add cooresonding properties")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="twoFactorAuthenticationEnabled" type="boolean"; \nproperty name="twoFactorAuthenticationKey" type="string";\n')])],1)])],1),n("slide",{attrs:{steps:1}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("UserDAO.cfc")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("p",[e._v("Add new sql fields to queries")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("SELECT \n  first_name,\n  last_name,\n  username,\n  two_factor_auth_enabled,\n  two_factor_auth_key\nFROM [user]\nWHERE \n  p_user = :userID\n")])],1)])],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("handlers/Settings.cfc: Injected properties")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v('property name="securityService" inject="security.SecurityService";\nproperty name="oneTimePasswordService" inject="security.OneTimePasswordService";\n')])],1)])],1),n("slide",{attrs:{steps:8}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("handlers/Settings.cfc: Called when a user enables 2FA")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"javascript"}},[e._v("prc.user = securityService.getLoggedInUser(); "),n("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GET THE USER CURRENTLY LOGGED IN")]),e._v("\n\nif ( !prc.user.isTwoFactorAuthenticationEnabled() ) { "),n("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" CHECK IF 2FA IS ALREADY ENABLED")]),e._v("\n  prc.user.setTwoFactorAuthenticationKey( oneTimePasswordService.generateKey() ); "),n("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GENERATE A NEW KEY FOR THE USER")]),e._v("\n\n  userService.save( prc.user ); "),n("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SAVE THE USER RECORD")]),e._v("\n\n  prc.qrCodeImage = oneTimePasswordService.getOTPQRCode( "),n("eg-code-comment",{attrs:{active:7==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" GENERATES A QR CODE FOR THE USER TO SETUP THE MOBILE APP")]),e._v('\n    name = "Recipe Box (#prc.user.getUsername()#)", \n    key = prc.user.getTwoFactorAuthenticationKey() \n  );\n\n  event.setView(view="settings/setup"); '),n("eg-code-comment",{attrs:{active:8==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VIEW TO SETUP 2FA")]),e._v('\n}\nelse {\n  setNextEvent("settings");\n}\n')],1)],1)])],1),n("slide",{attrs:{steps:4}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?n("h4",[e._v("views/settings/setup.cfm")]):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"markup"}},[e._v('<cfoutput>\n<div class="container" style="margin-top: 30px">\n  <h2>Two-Factor Authentication Setup</h2>\n  <p>Scan this code on your device with your authenticator application.</p>\n  <img src="data:image/*;base64,#toBase64( prc.qrCodeImage )#" height="300"/> '),n("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" DISPLAY QR CODE")]),e._v('\n  /> <br />\n  <div class="col-sm-4">\n  <form method="POST" action="#event.buildLink("settings.enableTwoFactorAuthentication")#">\n    <input type="text" name="passcode" class="form-control input-lg" placeholder="Passcode" required> '),n("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY THE OTP TO COMPLETE SETUP")]),e._v('\n    <span id="helpBlock" class="help-block">Enter the code from your authentication app here to complete 2-factor authentication setup.</span>\n    <button class="btn btn-lg btn-primary btn-block">Verify Code</button>\n  </form>\n  </div>\n  </form>\n</div>\n</cfoutput>\n')],1)],1):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[4==e.step?n("div",{staticClass:"center"},[n("img",{attrs:{src:"static/qr-code.png"}})]):e._e()])],1),n("slide",{attrs:{steps:4}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?n("h4",[e._v("handlers/Settings.cfc: Complete the setup")]):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[1==e.step?n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"markup"}},[e._v('public void function enableTwoFactorAuthentication(event,rc,prc) {\n  prc.user = securityService.getLoggedInUser();\n  event.paramValue("passcode","");\n\n  if ( !prc.user.isTwoFactorAuthenticationEnabled() ) {\n    var key = prc.user.getTwoFactorAuthenticationKey();\n\n    if ( len( rc.passcode ) && oneTimePasswordService.verify( key, rc.passcode )  ) { '),n("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY OTP")]),e._v("\n\n      prc.user.setTwoFactorAuthenticationenabled( true );"),n("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SET 2FA ENABLED")]),e._v("\n\n      userService.save( prc.user ); "),n("eg-code-comment",{attrs:{active:6==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SAVE THE USER RECORD")]),e._v('\n      flash.put("message","2-Factor authentication setup successful.");\n      \n    }\n    else {\n      prc.user.setTwoFactorAuthenticationEnabled( false );\n      prc.user.setTwoFactorAuthenticationKey( "" );\n      userService.save( prc.user );\n      flash.put("message","2-Factor authentication setup failed.");\n    }\n  }\n\n  setNextEvent("settings");\n}')],1)],1):e._e()]),n("eg-transition",{attrs:{enter:"fadeIn"}},[4==e.step?n("div",{staticClass:"center"},[n("img",{attrs:{src:"static/qr-code.png",height:"300px"}})]):e._e()])],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h5",{staticClass:"center"},[e._v("Step 1")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("div",{staticClass:"center"},[n("img",{attrs:{src:"static/2fa-step1.png"}})])])],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("h5",{staticClass:"center"},[e._v("Step 2")])]),n("eg-transition",{attrs:{enter:"lightSpeedIn"}},[n("div",{staticClass:"center"},[n("img",{attrs:{src:"static/2fa-step2.png"}})])])],1),n("slide",{attrs:{steps:5}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("SecurityService.cfc: Step 1")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"markup"}},[e._v('public boolean function checkUsernameAndPassword(username,password) {\n\n  var isValid = false;\n  ....\n  if (\n    q.recordCount\n    && bcrypt.checkPassword(arguments.password,q.password)\n  ) {     \n      \n    sessionStorage.setVar( "step1Valid",true ); '),n("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SET SESSION VARIABLE THAT SAYS STEP 1 IS VALID")]),e._v('\n    var user = userService.get( q.p_user );\n    sessionStorage.setVar( "user", user ); '),n("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" ADD USER TO THE SESSION")]),e._v('\n\n    if ( user.isTwoFactorAuthenticationEnabled() ) {\n      sessionStorage.setVar( "step2Required",true ); '),n("eg-code-comment",{attrs:{active:4==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" SESSION VARIABLE TO SAY THAT 2FA IS ENABLED")]),e._v('\n    }\n    else {\n      sessionStorage.setVar( "isLoggedIn",true ); '),n("eg-code-comment",{attrs:{active:5==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" THE USER IS LOGGED IN IF 2FA IS NOT ENABLED")]),e._v("\n    }\n\n    isValid = true;\n  }\n  ....\n}\n\n")],1)],1)])],1),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Multi-Factor Authentication")]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("h4",[e._v("SecurityService.cfc: Step 2")])]),n("eg-transition",{attrs:{enter:"fadeIn"}},[n("div",{staticClass:"center"},[n("eg-code-block",{attrs:{lang:"markup"}},[e._v("public boolean function verifyOneTimePassword( required string password ) {\n\n  var user = getLoggedInUser(); \n  \n  var isValid = oneTimePasswordService.verify( "),n("eg-code-comment",{attrs:{active:2==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" VERIFY THAT THE ONE-TIME PASSWORD IS VALID")]),e._v('\n    key = user.getTwoFactorAuthenticationKey(), \n    userToken = arguments.password \n  );\n  \n  if ( isValid ) {\n    sessionStorage.setVar("isLoggedIn",true); '),n("eg-code-comment",{attrs:{active:3==e.step,enter:"fadeIn",leave:"fadeOut"}},[e._v(" USER LOGGED IN")]),e._v("\n  }\n\n  return isValid;\n}\n")],1)],1)])],1),n("slide",[n("h3",[e._v("Multi-Factor Authentication")]),n("h5",{staticClass:"center"},[e._v("LIVE DEMO")])]),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Multi-Factor Authentication")]),n("h5",[e._v("Other Methods")]),n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?n("li",[e._v("SMS")]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[e._v("Push Notifications")]):e._e()])],1)]),n("slide",{attrs:{steps:3}},[n("h3",[e._v("Multi-Factor Authentication")]),n("h5",[e._v("3rd-party Service Providers")]),n("ul",[n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=2?n("li",[n("a",{attrs:{href:"https://duo.com",target:"_blank"}},[e._v("DUO")])]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[n("a",{attrs:{href:"https://www.okta.com",target:"_blank"}},[e._v("okta")])]):e._e()]),n("eg-transition",{attrs:{enter:"slideInLeft"}},[e.step>=3?n("li",[n("a",{attrs:{href:"https://auth0.com/multifactor-authentication",target:"_blank"}},[e._v("Auth0")])]):e._e()])],1)])],1)])},staticRenderFns:[]}},198:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},199:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"frontpage"},[n("div",{staticClass:"content"},[e._m(0),n("div",{staticClass:"logo"}),n("ol",[n("li",[n("router-link",{attrs:{to:"/injection"},nativeOn:{click:function(t){e.click(t)}}},[e._v("Injection")])],1),n("li",[n("router-link",{attrs:{to:"/authentication"},nativeOn:{click:function(t){e.click(t)}}},[e._v(" Broken Authentication")])],1),n("ul",[n("li",[n("router-link",{attrs:{to:"/mfa"},nativeOn:{click:function(t){e.click(t)}}},[e._v(" Multi-Factor Authentication")])],1)])])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",{staticStyle:{"margin-top":"50px"}},[n("span",[e._v("SECURE CFML: ")]),n("span",{staticClass:"grey"},[e._v("OWASP TOP 10")])])}]}},20:function(e,t){},21:function(e,t){},22:function(e,t){},3:function(e,t){},4:function(e,t,n){n(21);var s=n(0)(n(13),n(198),null,null);e.exports=s.exports},5:function(e,t,n){n(22);var s=n(0)(n(14),n(199),"data-v-9d3aa8ce",null);e.exports=s.exports},6:function(e,t,n){n(19);var s=n(0)(n(15),n(196),null,null);e.exports=s.exports},7:function(e,t,n){n(18);var s=n(0)(n(16),n(195),null,null);e.exports=s.exports},8:function(e,t,n){n(20);var s=n(0)(n(17),n(197),null,null);e.exports=s.exports}},[11]);